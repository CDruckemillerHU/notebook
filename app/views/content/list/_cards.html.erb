<div class="row">
  <% content_list.each.with_index do |content, i| %>
    <% if i % 3 == 0 %>
      <div style="clear: both;" class="hide-on-small-only"></div>
    <% end %>
    <div class="col s12 m4 l4">
      <div class="card sticky-action">
        <div class="card-image waves-effect waves-block waves-light">
          <% if content.respond_to?(:image_uploads) %>
            <% images = content.image_uploads %>
            <% if images.any? %>
              <%= image_tag(images.sample.src(:large), class: 'activator') %>
            <% else %>
            <%= image_tag("card-headers/#{content_type.name.downcase.pluralize}.jpg", class: 'activator') %>
            <% end %>
          <% else %>
          <%= image_tag("card-headers/#{content_type.name.downcase.pluralize}.jpg", class: 'activator') %>
          <% end %>
        </div>
        <div class="card-content">
          <span class="card-title activator grey-text text-darken-4">
            <%= content.name.presence || 'Untitled' %>
          </span>
          <p class="grey-text">
            <%= content.role %>
            <br />
            <%= content.created_at == content.updated_at ? 'created' : 'updated' %>
            <%= time_ago_in_words content.updated_at %>
            ago
          </p>
        </div>
        <div class="card-action nice-icon-links">
          <%= link_to edit_polymorphic_path(content), class: 'green-text right', target: '_new' do %>
            <i class="material-icons"><%= content_type.icon %></i> Edit
          <% end %>
          <%= link_to polymorphic_path(content), class: 'blue-text text-lighten-1' do %>
            <i class="material-icons"><%= content_type.icon %></i> View
          <% end %>
        </div>
        <div class="card-reveal">
          <span class="card-title grey-text text-darken-4">
            <%= content.name.presence || 'Document preview' %>
            <i class="material-icons right">close</i>
          </span>
          <p>
            <%= sanitize truncate(content.description || '<em>This document is blank.</em>', escape: false, length: 420) %>
          </p>
        </div>
      </div>
    </div>
  <% end %>
</div>
